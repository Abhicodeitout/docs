---
id: jwt-creation
title: Creating a JWT
hide_title: true
---

import WithWithoutSDK from "/src/components/tabs/WithWithoutSDK";
import BackendSDKTabs from "/src/components/tabs/BackendSDKTabs";
import TabItem from '@theme/TabItem';

# Creating a JWT

## When to create a JWT?
The first step is to create a JWT from the microservice that will be sending the request (let's call this microservice `M1`). Depending on the context, this JWT can be created at different times:
- When handling a request from the frontend: A new JWT needs to be created on each request, containing the user ID of the user who sent the request from the frontend.
- On process start: A new JWT is created when `M1` starts. The contents of this JWT are not tied to a specific end user, and this JWT remains static until `M1` restarts.

## What to add in the JWT?
In either case, the JWT needs to contain some information identifying `M1` so that the target microservice (let's call this `M2`) can verify the source of the request. We have two choices here:
- Add `M1` specific informatoin in the JWT: For example, we could add:
    ```json
    {..., "microservice_id": "M1", ...}
    ```

    `M2` could have a list of IDs that it can accept requests from. After [JWT verification](./jwt-verification/index), `M2` would check if the value of `microservice_id` is whitelisted in its ID list. If not, it would reject the request.
- Allow any microservice to talk to `M2`. In this case, we could add:
    ```json
    {..., "source": "microservice", ...}
    ```
    Here `M2` would check that the value of `source` is `"microservice"` before serving the request. Else it would reject the request.

The advantage of the first method is that it is more secure. In a large microservice environment, working across several teams, it makes sense to isolate micorservices to create a stronger zero trust network.

The disadvantage is that each time a new microservice is added, the ID whitelist for `M2` would need to be updated (if necessary). The second method solves this disadvantage, but at the cost of slightly lower security.

## Code for creating a JWT

<WithWithoutSDK>
<TabItem value="withsdk">

First, we need to initialise the `JWT` recipe in the `supertokens.init` function call:

<BackendSDKTabs isSubTab={true}>
<TabItem value="nodejs">

```tsx
import supertokens from "supertokens-node"
import jwt from "supertokens-node/recipe/jwt"

supertokens.init({
    appInfo: {
        apiDomain: "...",
        appName: "...",
        websiteDomain: "..."
    },
    supertokens: {
        connectionURI: "...", // location of the core
        apiKey: "..." // provide the core's API key if configured
    },
    recipeList: [
        // highlight-next-line
        jwt.init()
    ]
})
```

</TabItem>
<TabItem value="go">

```go
import (
	"github.com/supertokens/supertokens-golang/recipe/jwt"
	"github.com/supertokens/supertokens-golang/supertokens"
)

func main() {
	supertokens.Init(supertokens.TypeInput{
        AppInfo: supertokens.AppInfo{
            AppName: "...",
            WebsiteDomain: "...",
            APIDomain: "...",
        },
        Supertokens: &supertokens.ConnectionInfo{
            ConnectionURI: "...", // location of the core
            APIKey: "...", // provide the core's API key if configured
        },
		RecipeList: []supertokens.Recipe{
            // highlight-next-line
			jwt.Init(nil),
		},
	})
}
```

</TabItem>
<TabItem value="python">

```python
from supertokens_python import init, InputAppInfo, SupertokensConfig
from supertokens_python.recipe import jwt

init(
    app_info=InputAppInfo(
        app_name="...",
        api_domain="...",
        website_domain="...",
    ),
    supertokens_config=SupertokensConfig(
        connection_uri="...", # location of the core
        api_key="..." # provide the core's API key if configured
    ),
    framework='django',
    recipe_list=[
        # highlight-next-line
        jwt.init(),
    ],
)
```

</TabItem>
</BackendSDKTabs>

:::important
- The value of `apiDomain` should be the domain part of the JWKS URL that will be used to verify the JWT (from `M2`). This should ideally be the domain of the microservice that has all the other SuperTokens' recipes initlised in them. 
- If this microservice does not initialise any other reicpe, the values of `appName` and `websiteDomain` don't matter.
:::

</TabItem>
<TabItem value="withoutsdk">



</TabItem>
</WithWithoutSDK>