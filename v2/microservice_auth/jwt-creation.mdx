---
id: jwt-creation
title: Creating a JWT
hide_title: true
---

import WithWithoutSDK from "/src/components/tabs/WithWithoutSDK";
import TabItem from '@theme/TabItem';

# Creating a JWT

## When to create a JWT?
The first step is to create a JWT from the microservice that will be sending the request (let's call this microservice `M1`). Depending on the context, this JWT can be created at different times:
- When handling a request from the frontend: A new JWT needs to be created on each request, containing the user ID of the user who sent the request from the frontend.
- On process start: A new JWT is created when `M1` starts. The contents of this JWT are not tied to a specific end user, and this JWT remains static until `M1` restarts.

## What to add in the JWT?
In either case, the JWT needs to contain some information identifying `M1` so that the target microservice (let's call this `M2`) can verify the source of the request. We have two choices here:
- Add `M1` specific informatoin in the JWT: For example, we could add:
    ```json
    {..., "microservice_id": "M1", ...}
    ```

    `M2` could have a list of IDs that it can accept requests from. After [JWT verification](./jwt-verification), `M2` would check if the value of `microservice_id` is whitelisted in its ID list. If not, it would reject the request.
- Allow any microservice to talk to `M2`. In this case, we could add:
    ```json
    {..., "source": "microservice", ...}
    ```
    Here `M2` would check that the value of `source` is `"microservice"` before serving the request. Else it would reject the request.

The advantage of the first method is that it is more secure. In a large microservice environment, working across several teams, it makes sense to isolate micorservices to create a stronger zero trust network.

The disadvantage is that each time a new microservice is added, the ID whitelist for `M2` would need to be updated (if necessary). The second method solves this disadvantage, but at the cost of slightly lower security.

## Code for creating a JWT

<WithWithoutSDK>
<TabItem value="withsdk">

</TabItem>
<TabItem value="withoutsdk">

</TabItem>
</WithWithoutSDK>