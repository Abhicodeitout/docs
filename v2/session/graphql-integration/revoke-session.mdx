---
id: revoke-session
title: 5. Revoking Sessions
hide_title: true
---

# Revoking Sessions

```tsx
import { ApolloServer } from "@apollo/server";
import express from "express";
import { expressMiddleware } from "@apollo/server/express4";
import Session from "supertokens-node/recipe/session";
import {errorHandler} from "supertokens-node/framework/express/index.js";

let app = express();

const typeDefs = `
type Mutation {
    logout()
}
`
const resolvers = {
    // highlight-start
    Mutation: {
        logout: async (_: any, args: any, contextValue: any) => {
            let session = await Session.getSession(contextValue.req, contextValue.res);
            await session.revokeSession();
            return "Session revoked";
        },
    },
    // highlight-end
}

const server = new ApolloServer({
    typeDefs,
    resolvers,
    plugins: [
        {
            requestDidStart: async () => {
                return {
                    didEncounterErrors: async (requestContext) => {
                        const {req, res} = requestContext.contextValue as any;
                        for (let i = 0; i < requestContext.errors.length; i++) {
                            let error = requestContext.errors[i].originalError;
                            await new Promise(async (resolve) => {
                                // This will handle any session or other SuperTokens related errors
                                await errorHandler()(error, req, res, (err) => {
                                    resolve(undefined);
                                });
                            });
                        }
                    },
                };
            }
        }
    ],
})

server.start().then(() => {
    // Use expressMiddleware only after server.start has resolved
    app.use(express.json(), expressMiddleware(server, {
        context: async ({req, res}) => {
            return {
                req,
                res,
            };
        },
    }))

    app.listen(3001, () => {
        console.log("Server started");
    })
})
```