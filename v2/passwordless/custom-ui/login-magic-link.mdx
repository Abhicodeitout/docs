---
id: login-magic-link
title: Magic link login
hide_title: true
---

<!-- COPY DOCS -->
<!-- ./thirdpartypasswordless/custom-ui/login-magic-link.mdx -->

import FrontendCustomUITabs from "/src/components/tabs/FrontendCustomUITabs"
import TabItem from '@theme/TabItem';
import NpmOrScriptTabs from "/src/components/tabs/NpmOrScriptTabs"
import AppInfoForm from "/src/components/appInfoForm"

# Magic link login

There are three parts to Magic link based login:
- Creating and sending the magic link to the user's email.
- Allowing the user to resend a (new) magic link if they want.
- Consuming the link (when clicked) to login the user.

## Step 1: Sending the Magic link
SuperTokens allows you to send a magic link to a user's email or phone number. You have already configured this setting on the backend SDK `init` function call in Step 2 of the "Custom UI" setup.

Start by making a form which asks the user for their email or phone, and then call the following API to create and send them a magic link

<FrontendCustomUITabs>
<TabItem value="web">

<NpmOrScriptTabs>
<TabItem value="npm">

```tsx
import { ^{webJsCreatePasswordlessCode} } from "supertokens-web-js/recipe/^{codeImportRecipeName}";

async function sendMagicLink(email: string) {
    try {
        let response = await ^{webJsCreatePasswordlessCode}({
            email
        });
        /**
         * For phone number, use this:
            
            let response = await ^{webJsCreatePasswordlessCode}({
                phoneNumber
            });
         
        */

        // Magic link sent successfully.
        window.alert("Please check your email for the magic link");
    } catch (err: any) {
        if (err.isSuperTokensGeneralError === true) {
            // this may be a custom error message sent from the API by you,
            // or if the input email / phone number is not valid.
            window.alert(err.message);
        } else {
            window.alert("Oops! Something went wrong.");
        }
    }
}
```

</TabItem>
<TabItem value="script">

```tsx
import supertokens^{recipeNameCapitalLetters} from "supertokens-web-js-script/recipe/^{codeImportRecipeName}";
async function sendMagicLink(email: string) {
    try {
        let response = await supertokens^{recipeNameCapitalLetters}.^{webJsCreatePasswordlessCode}({
            email
        });
        /**
         * For phone number, use this:
            
            let response = await supertokens^{recipeNameCapitalLetters}.^{webJsCreatePasswordlessCode}({
                phoneNumber
            });
         
        */

        // Magic link sent successfully.
        window.alert("Please check your email for the magic link");
    } catch (err: any) {
        if (err.isSuperTokensGeneralError === true) {
            // this may be a custom error message sent from the API by you,
            // or if the input email / phone number is not valid.
            window.alert(err.message);
        } else {
            window.alert("Oops! Something went wrong.");
        }
    }
}
```

</TabItem>
</NpmOrScriptTabs>

</TabItem>

<TabItem value="mobile">

<AppInfoForm askForAPIDomain>

For email based login

```bash
curl --location --request POST '^{form_apiDomain}^{form_apiBasePath}/signinup/code' \
--header 'rid: ^{codeImportRecipeName}' \
--header 'Content-Type: application/json' \
--data-raw '{
  "email": "johndoe@gmail.com"
}'
```

For phone number based login
```bash
curl --location --request POST '^{form_apiDomain}^{form_apiBasePath}/signinup/code' \
--header 'rid: ^{codeImportRecipeName}' \
--header 'Content-Type: application/json' \
--data-raw '{
  "phoneNumber": "+1234567890"
}'
```

</AppInfoForm>

The response body from the API call has a `status` property in it:
- `status: "OK"`: This means that the magic link was successfully sent.
- `status: "GENERAL_ERROR"`: This is possible if you have overriden the backend API to send back a custom error message which should be displayed on the frontend, or if the input email or password failed the backend validation logic.

The response from the API call is the following object (in case of `status: "OK"`):
```json
{
    status: "OK";
    deviceId: string;
    preAuthSessionId: string;
    flowType: "USER_INPUT_CODE" | "MAGIC_LINK" | "USER_INPUT_CODE_AND_MAGIC_LINK";
    fetchResponse: Response; // raw fetch response from the API call
}
```

You want to save the `deviceId` and `preAuthSessionId` on the frontend storage. These will be useful to:
- Resend a new magic link.
- Detect if the user has already sent a magic link before or if this is an entirely new login attempt. This distinction can be important if you have different UI for these two states. For example, if this info already exists, you do not want to show the user an input box to enter their email / phone, and instead want to show them the resend link button.

</TabItem>

</FrontendCustomUITabs>

## Step 2: Resending a (new) Magic link
TODO

## Step 3: Consuming the Magic link
TODO

### On the same device
TODO

### On a different device
TODO

## See also
TODO
