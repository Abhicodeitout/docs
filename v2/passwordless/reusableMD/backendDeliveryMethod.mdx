import BackendSDKTabs from "/src/components/tabs/BackendSDKTabs";
import TabItem from '@theme/TabItem';
import SnippetQuestionForm, {ConditionalSection} from "/src/components/snippetConfigForm/index";
import { passwordlessQuestions } from "/src/components/snippetConfigForm/passwordlessQuestions";

:::important
We are working on our own SMS / email delivery service which will make this step much easier. Until then, you have to send the SMS / emails yourself.
:::

The `See next step` comment above is a placeholder where you must provide a function that will send the user the information necessary to log in or sign up:

<SnippetQuestionForm questions={[passwordlessQuestions.contactMethod]}>

<BackendSDKTabs>

<TabItem value="nodejs">

<ConditionalSection conditions={{
    contactMethod: "PHONE"
}}>

```ts
createAndSendCustomTextMessage: async (input, userCtx) => {
    let {
        // send the SMS to this phone number.
        // it's in E.164 format (see https://www.twilio.com/docs/glossary/what-e164)
        phoneNumber,

        /* this is the magic link string. It will be defined if the flowType 
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "MAGIC_LINK" */
        urlWithLinkCode,

        /* this is the OTP string. It will be defined if the flowType 
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "USER_INPUT_CODE" */
        userInputCode,

        /* This and the userCtx can be used for advanced customizations that need to
        fetch data from the database or access something saved earlier in the process. */
        preAuthSessionId,

        /* This is the time in milliseconds for how long the urlWithLinkCode or userInputCode
        is valid for. */
        codeLifetime
    } = input;

    // TODO: send SMS...
}
```

</ConditionalSection>
<ConditionalSection conditions={{
    contactMethod: "EMAIL"
}}>

```ts
createAndSendCustomEmail: async (input, userCtx) => {
    let {
        // send the email to this email ID
        email,

        /* this is the magic link string. It will be defined if the flowType 
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "MAGIC_LINK" */
        urlWithLinkCode,

        /* this is the OTP string. It will be defined if the flowType 
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "USER_INPUT_CODE" */
        userInputCode,

        /* This and the userCtx can be used for advanced customizations that need to
        fetch data from the database or access something saved earlier in the process. */
        preAuthSessionId:,

        /* This is the time in milliseconds for how long the urlWithLinkCode or userInputCode
        is valid for.
            */
        codeLifetime
    } = input;

    // TODO: send email...
},
```

</ConditionalSection>

<ConditionalSection conditions={{
    contactMethod: "EMAIL_OR_PHONE"
}}>

```ts
createAndSendCustomTextMessage: async (input, userCtx) => {
    let {
        // send the SMS to this phone number.
        // it's in E.164 format (see https://www.twilio.com/docs/glossary/what-e164)
        phoneNumber,

        /* this is the magic link string. It will be defined if the flowType 
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "MAGIC_LINK" */
        urlWithLinkCode,

        /* this is the OTP string. It will be defined if the flowType 
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "USER_INPUT_CODE" */
        userInputCode,

        /* This and the userCtx can be used for advanced customizations that need to
        fetch data from the database or access something saved earlier in the process. */
        preAuthSessionId,

        /* This is the time in milliseconds for how long the urlWithLinkCode or userInputCode
        is valid for. */
        codeLifetime
    } = input;

    // TODO: send SMS...
}

createAndSendCustomEmail: async (input, userCtx) => {
    let {
        // send the email to this email ID
        email,

        /* this is the magic link string. It will be defined if the flowType 
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "MAGIC_LINK" */
        urlWithLinkCode,

        /* this is the OTP string. It will be defined if the flowType 
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "USER_INPUT_CODE" */
        userInputCode,

        /* This and the userCtx can be used for advanced customizations that need to
        fetch data from the database or access something saved earlier in the process. */
        preAuthSessionId,

        /* This is the time in milliseconds for how long the urlWithLinkCode or userInputCode
        is valid for.
            */
        codeLifetime
    } = input;

    // TODO: send email...
},
```

</ConditionalSection>
</TabItem>
<TabItem value="go">
<ConditionalSection conditions={{
    contactMethod: "PHONE"
}}>

```go
CreateAndSendCustomTextMessage: func(
        // send the SMS to this phone number.
        // it's in E.164 format (see https://www.twilio.com/docs/glossary/what-e164)
        phoneNumber string,

        /* this is the OTP string. It will be defined if the flowType
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "USER_INPUT_CODE" */
        userInputCode,

        /* this is the magic link string. It will be defined if the flowType
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "MAGIC_LINK" */
        urlWithLinkCode *string,

        /* This is the time in milliseconds for how long the urlWithLinkCode or userInputCode is valid for. */
        codeLifetime uint64,

        /* preAuthSessionId and the userContext can be used for advanced customizations that need to
        fetch data from the database or access something saved earlier in the process. */
        preAuthSessionId string, userContext supertokens.UserContext) error {
    
    // TODO: send SMS...
    return nil
}
```

</ConditionalSection>
<ConditionalSection conditions={{
    contactMethod: "EMAIL"
}}>

```go
CreateAndSendCustomEmail: func(
        // send the email to this email ID
        email string,

        /* this is the OTP string. It will be defined if the flowType
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "USER_INPUT_CODE" */
        userInputCode,

        /* this is the magic link string. It will be defined if the flowType
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "MAGIC_LINK" */
        urlWithLinkCode *string,

        /* This is the time in milliseconds for how long the urlWithLinkCode or userInputCode is valid for. */
        codeLifetime uint64,

        /* preAuthSessionId and the userContext can be used for advanced customizations that need to
        fetch data from the database or access something saved earlier in the process. */
        preAuthSessionId string, userContext supertokens.UserContext) error {

    // TODO: send email...
    return nil
},
```

</ConditionalSection>

<ConditionalSection conditions={{
    contactMethod: "EMAIL_OR_PHONE"
}}>

```go
CreateAndSendCustomTextMessage: func(
        // send the SMS to this phone number.
        // it's in E.164 format (see https://www.twilio.com/docs/glossary/what-e164)
        phoneNumber string,

        /* this is the OTP string. It will be defined if the flowType
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "USER_INPUT_CODE" */
        userInputCode,

        /* this is the magic link string. It will be defined if the flowType
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "MAGIC_LINK" */
        urlWithLinkCode *string,

        /* This is the time in milliseconds for how long the urlWithLinkCode or userInputCode is valid for. */
        codeLifetime uint64,

        /* preAuthSessionId and the userContext can be used for advanced customizations that need to
        fetch data from the database or access something saved earlier in the process. */
        preAuthSessionId string, userContext supertokens.UserContext) error {

    // TODO: send SMS...
    return nil
}

CreateAndSendCustomEmail: func(
        // send the email to this email ID
        email string,

        /* this is the OTP string. It will be defined if the flowType
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "USER_INPUT_CODE" */
        userInputCode,

        /* this is the magic link string. It will be defined if the flowType
        is "USER_INPUT_CODE_AND_MAGIC_LINK" or "MAGIC_LINK" */
        urlWithLinkCode *string,

        /* This is the time in milliseconds for how long the urlWithLinkCode or userInputCode is valid for. */
        codeLifetime uint64,

        /* preAuthSessionId and the userContext can be used for advanced customizations that need to
        fetch data from the database or access something saved earlier in the process. */
        preAuthSessionId string, userContext supertokens.UserContext) error {

    // TODO: send email...
    return nil
},
```

</ConditionalSection>
</TabItem>
<TabItem value="python">
<ConditionalSection conditions={{
    contactMethod: "PHONE"
}}>

```python
async def send_text_message(
    param: CreateAndSendCustomTextMessageParameters
):
    # send the SMS to this phone number.
    # it's in E.164 format (see https://www.twilio.com/docs/glossary/what-e164)
    phone_number: str = param.phone_number,

    # this is the OTP string. It will be defined if the flowType
    # is "USER_INPUT_CODE_AND_MAGIC_LINK" or "USER_INPUT_CODE"
    user_input_code: Union[str, None] = param.user_input_code

    # this is the magic link string. It will be defined if the flowType
    # is "USER_INPUT_CODE_AND_MAGIC_LINK" or "MAGIC_LINK"
    url_with_link_code: Union[str, None] = param.url_with_link_code

    # This is the time in milliseconds for how long the url_with_link_code or user_input_code is valid for. */
    code_life_time: int = param.code_life_time,

    # pre_auth_session_id can be used for advanced customizations that need to
    # fetch data from the database or access something saved earlier in the process. */
    pre_auth_session_id: str = param.pre_auth_session_id

    # TODO: send SMS...
    return None
```

</ConditionalSection>
<ConditionalSection conditions={{
    contactMethod: "EMAIL"
}}>

```python
async def send_email(
    param: CreateAndSendCustomEmailParameters
):
    # send the email to this email ID
    email: str = param.email,

    # this is the OTP string. It will be defined if the flowType
    # is "USER_INPUT_CODE_AND_MAGIC_LINK" or "USER_INPUT_CODE"
    user_input_code: Union[str, None] = param.user_input_code

    # this is the magic link string. It will be defined if the flowType
    # is "USER_INPUT_CODE_AND_MAGIC_LINK" or "MAGIC_LINK"
    url_with_link_code: Union[str, None] = param.url_with_link_code

    # This is the time in milliseconds for how long the url_with_link_code or user_input_code is valid for. */
    code_life_time: int = param.code_life_time,

    # pre_auth_session_id can be used for advanced customizations that need to
    # fetch data from the database or access something saved earlier in the process. */
    pre_auth_session_id: str = param.pre_auth_session_id

    # TODO: send SMS...
    return None
```

</ConditionalSection>
<ConditionalSection conditions={{
    contactMethod: "EMAIL_OR_PHONE"
}}>

```python
async def send_text_message(
    param: CreateAndSendCustomTextMessageParameters
):
    # send the SMS to this phone number.
    # it's in E.164 format (see https://www.twilio.com/docs/glossary/what-e164)
    phone_number: str = param.phone_number,

    # this is the OTP string. It will be defined if the flowType
    # is "USER_INPUT_CODE_AND_MAGIC_LINK" or "USER_INPUT_CODE"
    user_input_code: Union[str, None] = param.user_input_code

    # this is the magic link string. It will be defined if the flowType
    # is "USER_INPUT_CODE_AND_MAGIC_LINK" or "MAGIC_LINK"
    url_with_link_code: Union[str, None] = param.url_with_link_code

    # This is the time in milliseconds for how long the url_with_link_code or user_input_code is valid for. */
    code_life_time: int = param.code_life_time,

    # pre_auth_session_id can be used for advanced customizations that need to
    # fetch data from the database or access something saved earlier in the process. */
    pre_auth_session_id: str = param.pre_auth_session_id

    # TODO: send SMS...
    return None

async def send_email(
    param: CreateAndSendCustomEmailParameters
):
    # send the email to this email ID
    email: str = param.email,

    # this is the OTP string. It will be defined if the flowType
    # is "USER_INPUT_CODE_AND_MAGIC_LINK" or "USER_INPUT_CODE"
    user_input_code: Union[str, None] = param.user_input_code

    # this is the magic link string. It will be defined if the flowType
    # is "USER_INPUT_CODE_AND_MAGIC_LINK" or "MAGIC_LINK"
    url_with_link_code: Union[str, None] = param.url_with_link_code

    # This is the time in milliseconds for how long the url_with_link_code or user_input_code is valid for. */
    code_life_time: int = param.code_life_time,

    # pre_auth_session_id can be used for advanced customizations that need to
    # fetch data from the database or access something saved earlier in the process. */
    pre_auth_session_id: str = param.pre_auth_session_id

    # TODO: send SMS...
    return None
```

</ConditionalSection>
</TabItem>
</BackendSDKTabs>

</SnippetQuestionForm>