---
id: backend-setup
title: 1. Backend Setup
hide_title: true
---

<!-- COPY DOCS -->
<!-- ./session/graphql-integration/backend-setup.mdx -->

# 1. Backend Setup

## a) Complete the quick setup

Follow the [quick setup guide](../quick-setup/frontend) to setup SuperTokens

## b) Install GraphQL dependencies on your backend

:::info
We use express-graphql as an example, SuperTokens can be used with other GraphQL libraries.
:::

```bash
npm i express-graphql graphql
```

## c) Setup GraphQL

### Create a schema 

```jsx
var { buildSchema } = require('graphql');

var schema = buildSchema(`
  type Query {
    hello: String
  }
`);
```

### Create resolvers

```jsx
var resolvers = {
    hello: () => "Hello World!",
}
```

Refer to the [official guide](https://graphql.org/learn/) to know more.

## d) Add a GraphQL endpoint

```jsx
let express = require("express")
let { graphqlHTTP } = require('express-graphql');
let { verifySession } = require("supertokens-node/recipe/session/framework/express");

...

let app = express();

app.use("/graphQL", verifySession(), graphqlHTTP({
    schema: schema,
    rootValue: resolvers,
}))
```

### Optional Session verification

```jsx
let express = require("express")
let { graphqlHTTP } = require('express-graphql');
let { verifySession } = require("supertokens-node/recipe/session/framework/express");

...

let app = express();

app.use("/graphQL", verifySession({sessionRequired: false}), graphqlHTTP({
    schema: schema,
    rootValue: resolvers,
}))
```

## e) Add user information to GraphQL context

```jsx
let express = require("express")
let { graphqlHTTP } = require('express-graphql');
let { verifySession } = require("supertokens-node/recipe/session/framework/express");

...

let app = express();

app.use("/graphQL", verifySession(), graphqlHTTP(async (req, res) => {
    let userContext = undefined;

    if ((req as any).session !== undefined) {
        let session: SessionContainer = (req as any).session;
        userContext = {
            // Add session information to the context object
            sessionHandle: session.getHandle(),
            accessTokenPayload: session.getAccessTokenPayload(),
            userId: session.getUserId(),
        };
    }

    return {
        schema: GraphQLSchema,
        rootValue: resolvers,
        context: {
            user: userContext,
        }
    };
}))
```
