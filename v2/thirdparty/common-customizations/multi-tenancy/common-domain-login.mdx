---
id: common-domain-login
title: "Option 1: Tenants use a common domain to login"
hide_title: true
show_ui_switcher: true
---

import AppInfoForm from "/src/components/appInfoForm"
import MultiTenancyPaidBanner from '../../../community/reusableMD/multitenancy/MultiTenancyPaidBanner.mdx'
import {PreBuiltOrCustomUISwitcher, PreBuiltUIContent, CustomUIContent} from "/src/components/preBuiltOrCustomUISwitcher"
import FrontendPreBuiltUITabs from "/src/components/tabs/FrontendPreBuiltUITabs"
import FrontendCustomUITabs from "/src/components/tabs/FrontendCustomUITabs"
import NpmOrScriptTabs from "/src/components/tabs/NpmOrScriptTabs"

<MultiTenancyPaidBanner />

# Option 1: Tenants use a common domain to login

In this UX flow, all tenants login using the same page (like `https://example.com/auth`) and are redirected to their sub domain after login. The login method that's shown on the login page depend on the tenant's `tenantId` configuration. 

The process of getting the `tenantId` from the user is left up to you, but a common method is to ask the user to enter their organisation name (which is equal to the `tenantId` that you configure in SuperTokens).

## Step 1: Creating a new tenant

Whenever you want to onboard a new customer, you should [create and configure a tenantId for them in the SuperTokens core](./new-tenant-config). If you want to create a self serve flow, in which customers can automatically sign up and create and configure their SSO provider in SuperTokens, checkout [this page](./TODO).

## Step 2: Ask for the tenant ID on the login page

<PreBuiltOrCustomUISwitcher>

<PreBuiltUIContent>

If you have [followed the pre built UI setup](../../pre-built-ui/setup/frontend), when you visit the login screen, you should see buttons for social login. We want to replace these with the tenant's provider options.

In order to do that, we must first get the tenant ID from the user. This can be done by building a UI that will ask them to enter their tenantId or Organisation name (which can be used as the tenant ID).

For this, we must first disable the default sign in UI and create our own route on which we will built our component. Start by setting the `disableDefaultUI` config in the `supertokens.init` function call as shown below and removing the list of providers you may have added earlier:

<FrontendPreBuiltUITabs>

<TabItem value="reactjs">

```tsx
import React from 'react';

import SuperTokens, { SuperTokensWrapper } from "supertokens-auth-react";
import ThirdParty from "supertokens-auth-react/recipe/thirdparty";
import Session from "supertokens-auth-react/recipe/session";

SuperTokens.init({
    appInfo: {
        appName: "...",
        apiDomain: "...",
        websiteDomain: "...",
        apiBasePath: "...",
        websiteBasePath: "..."
    },
    recipeList: [
        ThirdParty.init({
            // highlight-start
            signInAndUpFeature: {
                disableDefaultUI: true
            }
            // highlight-end
        }),
        Session.init()
    ]
});
```

</TabItem>

</FrontendPreBuiltUITabs>

Now if you visit the login page, you will no longer see the login buttons. We will now create our own login route on which we will display the following component:

<FrontendPreBuiltUITabs>

<TabItem value="reactjs">

```tsx
import React from 'react';
import { SignInAndUp } from "supertokens-auth-react/recipe/thirdparty";

function TenantLoginPage() {

    const [tenantId, setTenantId] = React.useState("");
    const [tenantIdSubmitted, setTenantIdSubmitted] = React.useState(false);

    React.useEffect(() => {
        // for simplicity sakes, we want to ask the user their 
        // tenantId each time they reload this page. But you could skip 
        // this and show a UI to the user in which you display the existing tenantId (if present)
        // and ask them to confirm it, or enter a new one
        localStorage.removeItem("tenantId");
    }, [])

    if (!tenantIdSubmitted) {
        // render UI to ask the user for their tenant ID
        return (
            <div>
                <div>Enter your organisation's name:</div><br />
                <input
                    type="text"
                    value={tenantId}
                    onChange={(e) => setTenantId(e.target.value)}
                />
                <br /><br />
                <button onSubmit={() => {

                    // this value will be read by SuperTokens as shown in the next steps.
                    localStorage.setItem("tenantId", tenantId)
                    setTenantIdSubmitted(true);
                }}>Next</button>
            </div>
        )
    } else {
        // we now have their tenant ID, so we should render the sign in up component
        // which will display the login UI configured for the user's tenant ID.
        return <SignInAndUp />
    }
}
```
- We render a simple UI which asks the user for their organisation's name. Their input will be treated as their tenant ID.
- Once the user has submitted that form, we will store their input in localstorage. This value will be read later on (as shown below) by SuperTokens to render the right login providers based on the saved tenantId.
- The component above clears the tenantId from localstorage whenever this page is (re)loaded, but you can change the behaviour of that to show the existing saved tenantId and ask the user to confirm it or change it.
- Finally, after saving the tenantId in localstorage, we make the component render the `SignInAndUp` UI component from SuperTokens lib which will render the UI we had disabled previously, but with the right set of providers for this tenant.

</TabItem>

</FrontendPreBuiltUITabs>

</PreBuiltUIContent>

<CustomUIContent>

You need to build a UI that will ask the user to enter their tenantId or Organisation name (which can be used as the tenant ID). The input value will then be used in various function calls, as we will see below.

Once you have the user's tenant ID, you can fetch their list of configured providers and render the third party login buttons accordingly:

<FrontendCustomUITabs>
<TabItem value="web">

<!-- COPY SECTION -->
<!-- ./thirdparty/custom-ui/multitenant-login.mdx  -->
<!-- 2d -->

<NpmOrScriptTabs>
<TabItem value="npm">

```tsx
import SuperTokens from 'supertokens-web-js';

async function fetchThirdPartyLoginProvidersForTenant(tenantId: string) {
	const loginMethods = await SuperTokens.getLoginMethods({
		tenantId
	})

	if (loginMethods.thirdParty.enabled) {
		const providers = loginMethods.thirdParty.providers;
		if (providers.find(i => i.thirdPartyId === "active-directory")) {
			// render sign in with Active Directory button
		} else {
			// more checks for other providers
		}
	} else {
		// thirdparty login is disabled for the tenant
	}
}
```

</TabItem>
<TabItem value="script">

```tsx
import supertokens from 'supertokens-web-js-script';
async function fetchThirdPartyLoginProvidersForTenant(tenantId: string) {
	const loginMethods = await supertokens.getLoginMethods({
		tenantId
	})

	if (loginMethods.thirdParty.enabled) {
		const providers = loginMethods.thirdParty.providers;
		if (providers.find(i => i.thirdPartyId === "active-directory")) {
			// render sign in with Active Directory button
		} else {
			// more checks for other providers
		}
	} else {
		// thirdparty login is disabled for the tenant
	}
}
```

</TabItem>
</NpmOrScriptTabs>

<!-- END COPY SECTION -->

- In the code snippet above, we fetch the login methods for the tenantId.
- We then render the login UI buttons based on the configured `thirdPartyId`s in the response

</TabItem>

<TabItem value="mobile">

<!-- COPY SECTION -->
<!-- ./thirdparty/custom-ui/multitenant-login.mdx  -->
<!-- 2d1 -->

<AppInfoForm askForAPIDomain>

```bash
curl --location --request GET '^{form_apiDomain}^{form_apiBasePath}/loginmethods?tenantId=customer1' \
--header 'rid: multitenancy'
```

The response body from the API call has a `status` property in it:
- `status: "OK"`: The `recipes` field will contain information about which login methods are enabled along with the list of third party providers configured for this tenant.
- `status: "GENERAL_ERROR"`: This is only possible if you have overriden the backend API to send back a custom error message which should be displayed on the frontend.

</AppInfoForm>

<!-- END COPY SECTION -->

</TabItem>

</FrontendCustomUITabs>

</CustomUIContent>

</PreBuiltOrCustomUISwitcher>

## Step 3: Tell SuperTokens about the saved tenantId from the previous step

<PreBuiltOrCustomUISwitcher>

<PreBuiltUIContent>

TODO

</PreBuiltUIContent>

<CustomUIContent>

TODO

</CustomUIContent>

</PreBuiltOrCustomUISwitcher>