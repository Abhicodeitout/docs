---
id: custom-providers
title: Custom providers
---

import FrontendSDKTabs from "/src/components/tabs/FrontendSDKTabs"
import BackendSDKTabs from "/src/components/tabs/BackendSDKTabs"
import TabItem from '@theme/TabItem';

If SuperTokens doesn't support a provider out of the box, you can use custom providers to add a new third party provider to your application. 

:::note
If you think that this provider should be supported by SuperTokens by default, make sure to let us know [here](https://github.com/supertokens/supertokens-node/issues/88).
:::


## Step 1: Front End 

<FrontendSDKTabs>
<TabItem value="reactjs">

```tsx
import React from "react";
import SuperTokens from "supertokens-auth-react";
import ThirdParty from "supertokens-auth-react/recipe/thirdparty";
SuperTokens.init({
    appInfo: {
        apiDomain: "...",
        appName: "...",
        websiteDomain: "..."
    },
    recipeList: [
        ThirdParty.init({
            signInAndUpFeature: {
                // highlight-start
                providers: [
                    {
                        id: "custom",
                        name: "X", // Will display "Continue with X"

                        // optional
                        // you do not need to add a click handler to this as
                        // we add it for you automatically.
                        buttonComponent: <div style={{
                            cursor: "pointer",
                            border: "1",
                            paddingTop: "5px",
                            paddingBottom: "5px",
                            borderRadius: "5px",
                            borderStyle: "solid"
                        }}>Login with Custom</div>
                    }
                ],
                // highlight-end
                // ...
            },
            // ...
        }),
        // ...
    ]
});
```
</TabItem>
</FrontendSDKTabs>

## Step 2: Back End 

:::note 
The OAuth callback URL for your custom provider will be `{websiteDomain}{websiteBasePath}/callback/{customId}`, where `customId` is the `id` given in the config below (the value below is `"custom"`).
:::

<BackendSDKTabs>
<TabItem value="nodejs">

```tsx
import SuperTokens from "supertokens-node";
import Session from "supertokens-node/recipe/session";
import ThirdParty from "supertokens-node/recipe/thirdparty";

TODO

SuperTokens.init({
    appInfo: {
        apiDomain: "...",
        appName: "...",
        websiteDomain: "..."
    },
    supertokens: {
        connectionURI: "...",
    },
    recipeList: [
        ThirdParty.init({
            signInAndUpFeature: {
                // highlight-start
                providers: [
                    {
                        id: "custom",
                        get: (redirectURI, authCodeFromRequest) => {
                            return {
                                accessTokenAPI: {
                                    // this contains info about the token endpoint which exchanges the auth code with the access token and profile info.
                                    url: "https://oauth.example.com/token",
                                    params: {
                                        // example post params
                                        client_id: "<CLIENT ID>",
                                        client_secret: "<CLIENT SECRET>",
                                        grant_type: "authorization_code",
                                        redirect_uri: redirectURI || "",
                                        code: authCodeFromRequest || "",
                                        //...
                                    }
                                },
                                authorisationRedirect: {
                                    // this contains info about forming the authorisation redirect URL without the state params and without the redirect_uri param
                                    url: "https://oauth.example.com",
                                    params: {
                                        client_id: "<CLIENT ID>",
                                        scope: "<SCOPES>",
                                        response_type: "code",
                                        //...
                                    }
                                },
                                getClientId: () => {
                                    return "<CLIENT ID>";
                                },
                                getProfileInfo: async (accessTokenAPIResponse) => {
                                    /* accessTokenAPIResponse is the JSON response from the accessTokenAPI POST call. Using this, you need to return an object of the following type:
                                    {
                                        id: string, // user ID as provided by the third party provider
                                        email?: { // optional 
                                            id: string, // emailID
                                            isVerified: boolean // true if the email is verified already
                                        }
                                    }
                                    */
                                    return {
                                        id: "..."
                                    };
                                }
                            }
                        }
                    }
                ]
                // highlight-end
            }
        }),
        Session.init({})
    ]
});
```

:::info
To see example implementations for popular third party providers like Google or Facebook, please see [our Github repo](https://github.com/supertokens/supertokens-node/tree/master/lib/ts/recipe/thirdparty/providers).
:::

</TabItem>
<TabItem value="go">

```go
import (
	"github.com/supertokens/supertokens-golang/recipe/thirdparty"
	"github.com/supertokens/supertokens-golang/recipe/thirdparty/tpmodels"
	"github.com/supertokens/supertokens-golang/supertokens"
)

func main() {
	supertokens.Init(supertokens.TypeInput{
		RecipeList: []supertokens.Recipe{
			thirdparty.Init(&tpmodels.TypeInput{
				SignInAndUpFeature: tpmodels.TypeInputSignInAndUp{
					Providers: []tpmodels.ProviderInput{
						{
							// highlight-start
							Config: tpmodels.ProviderConfig{
								ThirdPartyId: "custom",
								Clients: []tpmodels.ProviderClientConfig{
									{
										ClientID:     "...",
										ClientSecret: "...",
									},
								},
								AuthorizationEndpoint: "https://example.com/oauth/authorize",
								TokenEndpoint:         "https://example.com/oauth/token",
								UserInfoEndpoint:      "https://example.com/oauth/userinfo",
								UserInfoMap: tpmodels.TypeUserInfoMap{
									FromUserInfoAPI: tpmodels.TypeUserInfoFields{
										UserId:        "id",
										Email:         "email",
										EmailVerified: "email_verified",
									},
								},
							},
							// highlight-end
						},
					},
				},
			}),
		},
	})
}
```

:::info
To see example implementations for popular third party providers like Google or Facebook, please see [our Github repo](https://github.com/supertokens/supertokens-golang/tree/master/recipe/thirdparty/providers).
:::

</TabItem>
<TabItem value="python">

```python
from supertokens_python import init, InputAppInfo
from supertokens_python.recipe import thirdparty
from supertokens_python.recipe.thirdparty.provider import Provider
from supertokens_python.recipe.thirdparty.types import UserInfo, AccessTokenAPI, AuthorisationRedirectAPI
from typing import Dict, Union, Any
from supertokens_python.recipe.thirdparty.types import UserInfo, UserInfoEmail

TODO

class CustomProvider(Provider):
    def __init__(self):
        super().__init__('<PROVIDER_ID>', False)

    async def get_profile_info(self, auth_code_response: Dict[str, Any], user_context: Dict[str, Any]) -> UserInfo:
        # TODO: fetch user info from provider based on auth_code_response
        return UserInfo(user_id="...", email=UserInfoEmail(email="..", email_verified=True))

    def get_authorisation_redirect_api_info(self, user_context: Dict[str, Any]) -> AuthorisationRedirectAPI:
        params: Dict[str, Any] = {
            'scope': '<SCOPES>',
            'response_type': 'code',
            'client_id': "<CLIENT ID>",
        }
        return AuthorisationRedirectAPI(url="https://oauth.example.com", params=params)

    def get_access_token_api_info(
            self, redirect_uri: str, auth_code_from_request: str, user_context: Dict[str, Any]) -> AccessTokenAPI:
        params = {
            'client_id': "<CLIENT ID>",
            'client_secret': "<CLIENT SECRET>",
            'grant_type': 'authorization_code',
            'code': auth_code_from_request,
            'redirect_uri': redirect_uri
        }
        return AccessTokenAPI(url="https://oauth.example.com/token", params=params)

    def get_redirect_uri(self, user_context: Dict[str, Any]) -> Union[None, str]:
        return None
    
    def get_client_id(self, user_context: Dict[str, Any]) -> str:
        return "<CLIENT ID>"


init(
    app_info=InputAppInfo(api_domain="...", app_name="...", website_domain="..."),
    framework='...', # type: ignore
    recipe_list=[
        thirdparty.init(
            # highlight-start
            sign_in_and_up_feature=thirdparty.SignInAndUpFeature(providers=[
                CustomProvider()
            ])
            # highlight-end
        )
    ]
)
```

</TabItem>
</BackendSDKTabs>

### Modifying params sent to token or authorization endpoint

Sometimes, the custom provider might need a different set of parameters to be passed to the `AuthorizationEndpoint` and `TokenEndpoint`, other than what the SDK passes by default.

For example, you may want to use a different value for `"response_type"`, or a dynamic value based on request for `"login_hint"` or an additional parameter like `"response_mode"`. It can be achieved as shown below:

<BackendSDKTabs>
<TabItem value="nodejs">

```tsx
import SuperTokens from "supertokens-node";
import Session from "supertokens-node/recipe/session";
import ThirdParty from "supertokens-node/recipe/thirdparty";

TODO

SuperTokens.init({
    appInfo: {
        apiDomain: "...",
        appName: "...",
        websiteDomain: "..."
    },
    supertokens: {
        connectionURI: "...",
    },
    recipeList: [
        ThirdParty.init({
            signInAndUpFeature: {
                // highlight-start
                providers: [
                    {
                        id: "custom",
                        get: (redirectURI, authCodeFromRequest) => {
                            return {
                                accessTokenAPI: {
                                    // this contains info about the token endpoint which exchanges the auth code with the access token and profile info.
                                    url: "https://oauth.example.com/token",
                                    params: {
                                        // example post params
                                        client_id: "<CLIENT ID>",
                                        client_secret: "<CLIENT SECRET>",
                                        grant_type: "authorization_code",
                                        redirect_uri: redirectURI || "",
                                        code: authCodeFromRequest || "",
                                        //...
                                    }
                                },
                                authorisationRedirect: {
                                    // this contains info about forming the authorisation redirect URL without the state params and without the redirect_uri param
                                    url: "https://oauth.example.com",
                                    params: {
                                        client_id: "<CLIENT ID>",
                                        scope: "<SCOPES>",
                                        response_type: "code",
                                        //...
                                    }
                                },
                                getClientId: () => {
                                    return "<CLIENT ID>";
                                },
                                getProfileInfo: async (accessTokenAPIResponse) => {
                                    /* accessTokenAPIResponse is the JSON response from the accessTokenAPI POST call. Using this, you need to return an object of the following type:
                                    {
                                        id: string, // user ID as provided by the third party provider
                                        email?: { // optional 
                                            id: string, // emailID
                                            isVerified: boolean // true if the email is verified already
                                        }
                                    }
                                    */
                                    return {
                                        id: "..."
                                    };
                                }
                            }
                        }
                    }
                ]
                // highlight-end
            }
        }),
        Session.init({})
    ]
});
```


</TabItem>
<TabItem value="go">

```go
import (
	"github.com/supertokens/supertokens-golang/recipe/thirdparty"
	"github.com/supertokens/supertokens-golang/recipe/thirdparty/tpmodels"
	"github.com/supertokens/supertokens-golang/supertokens"
)

func main() {
	supertokens.Init(supertokens.TypeInput{
		RecipeList: []supertokens.Recipe{
			thirdparty.Init(&tpmodels.TypeInput{
				SignInAndUpFeature: tpmodels.TypeInputSignInAndUp{
					Providers: []tpmodels.ProviderInput{
						{
							Config: tpmodels.ProviderConfig{
								ThirdPartyId: "custom",
								Clients: []tpmodels.ProviderClientConfig{
									{
										ClientID:     "...",
										ClientSecret: "...",
									},
								},
								AuthorizationEndpoint: "https://example.com/oauth/authorize",
								// highlight-start
								AuthorizationEndpointQueryParams: map[string]interface{}{
									"response_type": "token", // Changing an existing parameter
									"login_hint": func(userContext supertokens.UserContext) interface{} {
										// ...
										return "user@example.com"
									}, // Dynamic value based on the user context
									"response_mode": "form", // Adding a new parameter
									"scope":         nil,    // Removing a parameter
								},
								// highlight-end
								TokenEndpoint:    "https://example.com/oauth/token",
								UserInfoEndpoint: "https://example.com/oauth/userinfo",
								UserInfoMap: tpmodels.TypeUserInfoMap{
									FromUserInfoAPI: tpmodels.TypeUserInfoFields{
										UserId:        "id",
										Email:         "email",
										EmailVerified: "email_verified",
									},
								},
							},
						},
					},
				},
			}),
		},
	})
}
```


</TabItem>
<TabItem value="python">

```python
from supertokens_python import init, InputAppInfo
from supertokens_python.recipe import thirdparty
from supertokens_python.recipe.thirdparty.provider import Provider
from supertokens_python.recipe.thirdparty.types import UserInfo, AccessTokenAPI, AuthorisationRedirectAPI
from typing import Dict, Union, Any
from supertokens_python.recipe.thirdparty.types import UserInfo, UserInfoEmail

TODO

class CustomProvider(Provider):
    def __init__(self):
        super().__init__('<PROVIDER_ID>', False)

    async def get_profile_info(self, auth_code_response: Dict[str, Any], user_context: Dict[str, Any]) -> UserInfo:
        # TODO: fetch user info from provider based on auth_code_response
        return UserInfo(user_id="...", email=UserInfoEmail(email="..", email_verified=True))

    def get_authorisation_redirect_api_info(self, user_context: Dict[str, Any]) -> AuthorisationRedirectAPI:
        params: Dict[str, Any] = {
            'scope': '<SCOPES>',
            'response_type': 'code',
            'client_id': "<CLIENT ID>",
        }
        return AuthorisationRedirectAPI(url="https://oauth.example.com", params=params)

    def get_access_token_api_info(
            self, redirect_uri: str, auth_code_from_request: str, user_context: Dict[str, Any]) -> AccessTokenAPI:
        params = {
            'client_id': "<CLIENT ID>",
            'client_secret': "<CLIENT SECRET>",
            'grant_type': 'authorization_code',
            'code': auth_code_from_request,
            'redirect_uri': redirect_uri
        }
        return AccessTokenAPI(url="https://oauth.example.com/token", params=params)

    def get_redirect_uri(self, user_context: Dict[str, Any]) -> Union[None, str]:
        return None
    
    def get_client_id(self, user_context: Dict[str, Any]) -> str:
        return "<CLIENT ID>"


init(
    app_info=InputAppInfo(api_domain="...", app_name="...", website_domain="..."),
    framework='...', # type: ignore
    recipe_list=[
        thirdparty.init(
            # highlight-start
            sign_in_and_up_feature=thirdparty.SignInAndUpFeature(providers=[
                CustomProvider()
            ])
            # highlight-end
        )
    ]
)
```

</TabItem>
</BackendSDKTabs>

The example above shows how the `AuthorizationEndpointQueryParams` can be modified. `TokenEndpointBodyParams` can also be modified using the same approach.

### Overriding default provider functions

SuperTokens has default implementation for all providers that relies on the config that you specify above. For example, the API call made to get the user's profile info makes a `GET` call to the `UserInfoEndpoint` with the user's access token. If your provider requires a different method or requires multiple calls to different endpoints to get the profile info, then you can override the default implementation as shown below:

Refer the snippet below on how that can be achieved:

<BackendSDKTabs>
<TabItem value="nodejs">

```tsx
import SuperTokens from "supertokens-node";
import Session from "supertokens-node/recipe/session";
import ThirdParty from "supertokens-node/recipe/thirdparty";

TODO

SuperTokens.init({
    appInfo: {
        apiDomain: "...",
        appName: "...",
        websiteDomain: "..."
    },
    supertokens: {
        connectionURI: "...",
    },
    recipeList: [
        ThirdParty.init({
            signInAndUpFeature: {
                // highlight-start
                providers: [
                    {
                        id: "custom",
                        get: (redirectURI, authCodeFromRequest) => {
                            return {
                                accessTokenAPI: {
                                    // this contains info about the token endpoint which exchanges the auth code with the access token and profile info.
                                    url: "https://oauth.example.com/token",
                                    params: {
                                        // example post params
                                        client_id: "<CLIENT ID>",
                                        client_secret: "<CLIENT SECRET>",
                                        grant_type: "authorization_code",
                                        redirect_uri: redirectURI || "",
                                        code: authCodeFromRequest || "",
                                        //...
                                    }
                                },
                                authorisationRedirect: {
                                    // this contains info about forming the authorisation redirect URL without the state params and without the redirect_uri param
                                    url: "https://oauth.example.com",
                                    params: {
                                        client_id: "<CLIENT ID>",
                                        scope: "<SCOPES>",
                                        response_type: "code",
                                        //...
                                    }
                                },
                                getClientId: () => {
                                    return "<CLIENT ID>";
                                },
                                getProfileInfo: async (accessTokenAPIResponse) => {
                                    /* accessTokenAPIResponse is the JSON response from the accessTokenAPI POST call. Using this, you need to return an object of the following type:
                                    {
                                        id: string, // user ID as provided by the third party provider
                                        email?: { // optional 
                                            id: string, // emailID
                                            isVerified: boolean // true if the email is verified already
                                        }
                                    }
                                    */
                                    return {
                                        id: "..."
                                    };
                                }
                            }
                        }
                    }
                ]
                // highlight-end
            }
        }),
        Session.init({})
    ]
});
```

:::info
To see example implementations for popular third party providers like Google or Facebook, please see [our Github repo](https://github.com/supertokens/supertokens-node/tree/master/lib/ts/recipe/thirdparty/providers).
:::

</TabItem>
<TabItem value="go">

```go
import (
	"github.com/supertokens/supertokens-golang/recipe/thirdparty"
	"github.com/supertokens/supertokens-golang/recipe/thirdparty/tpmodels"
	"github.com/supertokens/supertokens-golang/supertokens"
)

func main() {
	supertokens.Init(supertokens.TypeInput{
		RecipeList: []supertokens.Recipe{
			thirdparty.Init(&tpmodels.TypeInput{
				SignInAndUpFeature: tpmodels.TypeInputSignInAndUp{
					Providers: []tpmodels.ProviderInput{
						{
							Config: tpmodels.ProviderConfig{
								ThirdPartyId: "custom",
								Clients: []tpmodels.ProviderClientConfig{
									{
										ClientID:     "...",
										ClientSecret: "...",
									},
								},
								AuthorizationEndpoint: "https://example.com/oauth/authorize",
								AuthorizationEndpointQueryParams: map[string]interface{}{
									"response_type": "token", // Changing an existing parameter
									"login_hint": func(userContext supertokens.UserContext) interface{} {
										// ...
										return "user@example.com"
									}, // Dynamic value based on the user context
									"response_mode": "form", // Adding a new parameter
									"scope":         nil,    // Removing a parameter
								},
								TokenEndpoint: "https://example.com/oauth/token",
							},
							// highlight-start
							Override: func(provider *tpmodels.TypeProvider) *tpmodels.TypeProvider {
								// ...
								provider.GetUserInfo = func(config tpmodels.ProviderConfigForClientType, oAuthTokens tpmodels.TypeOAuthTokens, userContext supertokens.UserContext) (tpmodels.TypeUserInfo, error) {
									// Call your own APIs
									// ...
									return tpmodels.TypeUserInfo{
										ThirdPartyUserId: "...",
										Email: &tpmodels.EmailStruct{
											ID:         "...",
											IsVerified: true,
										},
										RawUserInfoFromProvider: tpmodels.TypeRawUserInfoFromProvider{
											FromUserInfoAPI: map[string]interface{}{
												// ...
											},
										},
									}, nil
								}
								return provider
							},
							// highlight-end
						},
					},
				},
			}),
		},
	})
}
```

:::info
To see example implementations for popular third party providers like Google or Facebook, please see [our Github repo](https://github.com/supertokens/supertokens-golang/tree/master/recipe/thirdparty/providers).
:::

</TabItem>
<TabItem value="python">

```python
from supertokens_python import init, InputAppInfo
from supertokens_python.recipe import thirdparty
from supertokens_python.recipe.thirdparty.provider import Provider
from supertokens_python.recipe.thirdparty.types import UserInfo, AccessTokenAPI, AuthorisationRedirectAPI
from typing import Dict, Union, Any
from supertokens_python.recipe.thirdparty.types import UserInfo, UserInfoEmail

TODO

class CustomProvider(Provider):
    def __init__(self):
        super().__init__('<PROVIDER_ID>', False)

    async def get_profile_info(self, auth_code_response: Dict[str, Any], user_context: Dict[str, Any]) -> UserInfo:
        # TODO: fetch user info from provider based on auth_code_response
        return UserInfo(user_id="...", email=UserInfoEmail(email="..", email_verified=True))

    def get_authorisation_redirect_api_info(self, user_context: Dict[str, Any]) -> AuthorisationRedirectAPI:
        params: Dict[str, Any] = {
            'scope': '<SCOPES>',
            'response_type': 'code',
            'client_id': "<CLIENT ID>",
        }
        return AuthorisationRedirectAPI(url="https://oauth.example.com", params=params)

    def get_access_token_api_info(
            self, redirect_uri: str, auth_code_from_request: str, user_context: Dict[str, Any]) -> AccessTokenAPI:
        params = {
            'client_id': "<CLIENT ID>",
            'client_secret': "<CLIENT SECRET>",
            'grant_type': 'authorization_code',
            'code': auth_code_from_request,
            'redirect_uri': redirect_uri
        }
        return AccessTokenAPI(url="https://oauth.example.com/token", params=params)

    def get_redirect_uri(self, user_context: Dict[str, Any]) -> Union[None, str]:
        return None
    
    def get_client_id(self, user_context: Dict[str, Any]) -> str:
        return "<CLIENT ID>"


init(
    app_info=InputAppInfo(api_domain="...", app_name="...", website_domain="..."),
    framework='...', # type: ignore
    recipe_list=[
        thirdparty.init(
            # highlight-start
            sign_in_and_up_feature=thirdparty.SignInAndUpFeature(providers=[
                CustomProvider()
            ])
            # highlight-end
        )
    ]
)
```

</TabItem>
</BackendSDKTabs>

## See also

TODO links

- Getting access token from the thirdparty provider
- Getting user info from the thirdparty provider
- Multitenancy setup
