---
id: backend
title: Step 2) Backend
hide_title: true
---

import BackendSDKTabs from "/src/components/tabs/BackendSDKTabs";
import TabItem from '@theme/TabItem';
import NodeJSFrameworkSubTabsServerless from "/src/components/tabs/NodeJSFrameworkSubTabsServerless"
import GoFrameworkSubTabs from "/src/components/tabs/GoFrameworkSubTabs"
import AppInfoForm from "/src/components/appInfoForm"

# Backend Integration 

## Example
<BackendSDKTabs>
<TabItem value="nodejs">

An example implementation can be [found here](https://github.com/supertokens/supertokens-auth-react/blob/master/examples/with-thirdparty/api-server.js).

</TabItem>
<TabItem value="go">

Examples can be found [here](https://github.com/supertokens/supertokens-golang/tree/master/examples)

</TabItem>
</BackendSDKTabs>

## 1) Install

<BackendSDKTabs>
<TabItem value="nodejs">

```bash
npm i -s supertokens-node
```

</TabItem>
<TabItem value="go">

```bash
go get github.com/supertokens/supertokens-golang
```

</TabItem>
</BackendSDKTabs>

## 2) Call the `init` function

<AppInfoForm
    askForAppName={true}
    askForAPIDomain={true}
    askForWebsiteDomain={true}>

<BackendSDKTabs>
<TabItem value="nodejs">

<NodeJSFrameworkSubTabsServerless>
<TabItem value="express">

```jsx
let supertokens = require("supertokens-node");
let Session = require("supertokens-node/recipe/session");
let ThirdParty = require("supertokens-node/recipe/thirdparty");

supertokens.init({
    framework: "express",
    supertokens: {
       // This is hosted for demo purposes. You can use this, but make sure to change it to your core instance URI eventually.
        connectionURI: "https://try.supertokens.io",
        apiKey: "<REQUIRED FOR MANAGED SERVICE, ELSE YOU CAN REMOVE THIS FIELD>"
    },
    appInfo: {
        // learn more about this on https://supertokens.io/docs/session/appinfo
        appName: "^{form_appName}",
        apiDomain: "^{form_apiDomain}",
        websiteDomain: "^{form_websiteDomain}"
    },
    recipeList: [
        ThirdParty.init({/*TODO: See next step*/}),
        Session.init() // initializes session features
    ]
});
```
</TabItem>

<TabItem value="hapi">

```jsx
let supertokens = require("supertokens-node");
let Session = require("supertokens-node/recipe/session");
let ThirdParty = require("supertokens-node/recipe/thirdparty");

supertokens.init({
    framework: "hapi",
    supertokens: {
       // This is hosted for demo purposes. You can use this, but make sure to change it to your core instance URI eventually.
        connectionURI: "https://try.supertokens.io",
        apiKey: "<REQUIRED FOR MANAGED SERVICE, ELSE YOU CAN REMOVE THIS FIELD>"
    },
    appInfo: {
        // learn more about this on https://supertokens.io/docs/session/appinfo
        appName: "^{form_appName}",
        apiDomain: "^{form_apiDomain}",
        websiteDomain: "^{form_websiteDomain}"
    },
    recipeList: [
        ThirdParty.init({/*TODO: See next step*/}),
        Session.init() // initializes session features
    ]
});
```
</TabItem>

<TabItem value="fastify">

```jsx
let supertokens = require("supertokens-node");
let Session = require("supertokens-node/recipe/session");
let ThirdParty = require("supertokens-node/recipe/thirdparty");

supertokens.init({
    framework: "fastify",
    supertokens: {
       // This is hosted for demo purposes. You can use this, but make sure to change it to your core instance URI eventually.
        connectionURI: "https://try.supertokens.io",
        apiKey: "<REQUIRED FOR MANAGED SERVICE, ELSE YOU CAN REMOVE THIS FIELD>"
    },
    appInfo: {
        // learn more about this on https://supertokens.io/docs/session/appinfo
        appName: "^{form_appName}",
        apiDomain: "^{form_apiDomain}",
        websiteDomain: "^{form_websiteDomain}"
    },
    recipeList: [
        ThirdParty.init({/*TODO: See next step*/}),
        Session.init() // initializes session features
    ]
});
```
</TabItem>

<TabItem value="koa">

```jsx
let supertokens = require("supertokens-node");
let Session = require("supertokens-node/recipe/session");
let ThirdParty = require("supertokens-node/recipe/thirdparty");

supertokens.init({
    framework: "koa",
    supertokens: {
       // This is hosted for demo purposes. You can use this, but make sure to change it to your core instance URI eventually.
        connectionURI: "https://try.supertokens.io",
        apiKey: "<REQUIRED FOR MANAGED SERVICE, ELSE YOU CAN REMOVE THIS FIELD>"
    },
    appInfo: {
        // learn more about this on https://supertokens.io/docs/session/appinfo
        appName: "^{form_appName}",
        apiDomain: "^{form_apiDomain}",
        websiteDomain: "^{form_websiteDomain}"
    },
    recipeList: [
        ThirdParty.init({/*TODO: See next step*/}),
        Session.init() // initializes session features
    ]
});
```
</TabItem>

<TabItem value="loopback">

```jsx
let supertokens = require("supertokens-node");
let Session = require("supertokens-node/recipe/session");
let ThirdParty = require("supertokens-node/recipe/thirdparty");

supertokens.init({
    framework: "loopback",
    supertokens: {
       // This is hosted for demo purposes. You can use this, but make sure to change it to your core instance URI eventually.
        connectionURI: "https://try.supertokens.io",
        apiKey: "<REQUIRED FOR MANAGED SERVICE, ELSE YOU CAN REMOVE THIS FIELD>"
    },
    appInfo: {
        // learn more about this on https://supertokens.io/docs/session/appinfo
        appName: "^{form_appName}",
        apiDomain: "^{form_apiDomain}",
        websiteDomain: "^{form_websiteDomain}"
    },
    recipeList: [
        ThirdParty.init({/*TODO: See next step*/}),
        Session.init() // initializes session features
    ]
});
```
</TabItem>
</NodeJSFrameworkSubTabsServerless>
</TabItem>
<TabItem value="go">

```go
import (
	"github.com/supertokens/supertokens-golang/recipe/session"
	"github.com/supertokens/supertokens-golang/recipe/thirdparty"
	"github.com/supertokens/supertokens-golang/recipe/thirdparty/tpmodels"
	"github.com/supertokens/supertokens-golang/supertokens"
)

func main() {
	err := supertokens.Init(supertokens.TypeInput{
		Supertokens: &supertokens.ConnectionInfo{
           // This is hosted for demo purposes. You can use this, but make sure to change it to your core instance URI eventually.
			ConnectionURI: "https://try.supertokens.io",
            APIKey: "<REQUIRED FOR MANAGED SERVICE, ELSE YOU CAN REMOVE THIS FIELD>"
		},
		AppInfo: supertokens.AppInfo{
            AppName: "^{form_appName}",
            APIDomain: "^{form_apiDomain}",
            WebsiteDomain: "^{form_websiteDomain}",
		},
		RecipeList: []supertokens.Recipe{
			thirdparty.Init(&tpmodels.TypeInput{/*TODO: See next step*/}),
			session.Init(nil), // initializes session features
		},
	})

	if err != nil {
		panic(err.Error())
	}
}
```
</TabItem>
</BackendSDKTabs>

We used `https://try.supertokens.io` as the `connectionURI` above. This is a Core that we are hosting for the demo app. 

You can continue to use this for as long as you like, but once you are more committed to using SuperTokens, you will need to run a Core dedicated for your app.

</AppInfoForm>


## 3) Initialise Social login providers

Populate the `providers` array with the third party auth providers you want.

<BackendSDKTabs>
<TabItem value="nodejs">

```jsx
let ThirdParty = require("supertokens-node/recipe/thirdparty");
let {Google, Github, Facebook} = ThirdParty;

// Inside supertokens.init
ThirdParty.init({
    //highlight-start
    providers: [
        Google({
            clientSecret: "GOOGLE_CLIENT_SECRET", // TODO:
            clientId: "GOOGLE_CLIENT_ID" // TODO:
        }),
        Github({
            clientSecret: "GITHUB_CLIENT_SECRET", // TODO:
            clientId: "GITHUB_CLIENT_ID" // TODO:
        }),
        Facebook({
            clientSecret: "FACEBOOK_CLIENT_SECRET", // TODO:
            clientId: "FACEBOOK_CLIENT_ID" // TODO:
        })
    ]
    //highlight-end
}),
```
</TabItem>
<TabItem value="go">

```go

// Inside supertokens.Init
thirdparty.Init(&tpepmodels.TypeInput{
    // highlight-start
    Providers: []tpmodels.TypeProvider{
        thirdparty.Google(tpmodels.GoogleConfig{
            ClientID:     "GOOGLE_CLIENT_ID", // TODO:
            ClientSecret: "GOOGLE_CLIENT_SECRET", // TODO:
        }),
        thirdparty.Github(tpmodels.GithubConfig{
            ClientID:     "GITHUB_CLIENT_ID", // TODO:
            ClientSecret: "GITHUB_CLIENT_SECRET", // TODO:
        }),
        thirdparty.Facebook(tpmodels.FacebookConfig{
            ClientID:     "FACEBOOK_CLIENT_ID", // TODO:
            ClientSecret: "FACEBOOK_CLIENT_SECRET", // TODO:
        }),
    },
    // highlight-end
}),
```
</TabItem>
</BackendSDKTabs>

Please refer to the corresponding documentations to get your client ids and client secrets for each of the below providers:
- [Google](https://developers.google.com/identity/sign-in/web/sign-in#create_authorization_credentials), (callback URL is `http://localhost:3000/auth/callback/google`)
- [Github](https://docs.github.com/en/developers/apps/creating-an-oauth-app), (callback URL is `http://localhost:3000/auth/callback/github`)
- [Facebook](https://developers.facebook.com/docs/development/create-an-app), (callback URL is `http://localhost:3000/auth/callback/facebook`)


## 4) Add the SuperTokens APIs & CORS setup

<AppInfoForm
    askForWebsiteDomain={true}>

<BackendSDKTabs>
<TabItem value="nodejs">
<NodeJSFrameworkSubTabsServerless>
<TabItem value="express">

Add the `middleware` **BEFORE all your routes**.

```jsx
let cors = require("cors");
let supertokens = require("supertokens-node");
let {middleware} = require("supertokens-node/framework/express");

let app = express();

// ...other middlewares
app.use(cors({
    // highlight-start
    origin: "^{form_websiteDomain}",
    allowedHeaders: ["content-type", ...supertokens.getAllCORSHeaders()],
    credentials: true,
    // highlight-end
}));

// highlight-next-line
app.use(middleware());

// ...your API routes
```
This `middleware` adds a few APIs (see all the APIs [here](https://app.swaggerhub.com/apis/supertokens/FDI)):
- `POST /auth/signinup`: For signing up/signing in a user using a thirdparty provider.

`/auth/` is a base path that [can be changed](../common-customizations/changing-base-path/api-base-path) if you want. 


</TabItem>
<TabItem value="hapi">

Register the `plugin`.

```jsx
let supertokens = require("supertokens-node");
let { plugin } = require("supertokens-node/framework/hapi");

let server = Hapi.server({ port: 8000 });

// ...other middlewares
server.route({
    config: {
        // highlight-start
        cors: {
            origin: "^{form_websiteDomain}",
            additionalHeaders: [...supertokens.getAllCORSHeaders()],
            credentials: true,
        }
        // highlight-end
    }
});

(async() => {
    // highlight-next-line
    await server.register(plugin);
    
    await server.start();
})();

// ...your API routes
```
This `plugin` adds a few APIs (see all the APIs [here](https://app.swaggerhub.com/apis/supertokens/FDI)) as well take care of all the errors thrown by the Supertokens library:
- `POST /auth/signinup`: For signing up/signing in a user using a thirdparty provider.

`/auth/` is a base path that [can be changed](../common-customizations/changing-base-path/api-base-path) if you want. 


</TabItem>
<TabItem value="fastify">

Register the `plugin`.

```jsx
let cors = require("fastify-cors");
let supertokens = require("supertokens-node");
let { plugin } = require("supertokens-node/framework/fastify");

let fastify = require('fastify')();

// ...other middlewares
// highlight-start
fastify.register(cors, { 
    origin: "^{form_websiteDomain}",
    allowedHeaders: ['Content-Type', ...supertokens.getAllCORSHeaders()],
    credentials: true,
})
// highlight-end

(async() => {
    // highlight-next-line
    await server.register(plugin);
    
    await server.start();
})();

// ...your API routes
```
This `plugin` adds a few APIs (see all the APIs [here](https://app.swaggerhub.com/apis/supertokens/FDI)):
- `POST /auth/signinup`: For signing up/signing in a user using a thirdparty provider.

`/auth/` is a base path that [can be changed](../common-customizations/changing-base-path/api-base-path) if you want. 


</TabItem>
<TabItem value="koa">

Add the `middleware` **BEFORE all your routes**.

```jsx
let cors = require('@koa/cors');
let supertokens = require("supertokens-node");
let {middleware} = require("supertokens-node/framework/koa");

let app = new Koa();

// ...other middlewares
app.use(cors({
    // highlight-start
    origin: "^{form_websiteDomain}",
    allowHeaders: ["content-type", ...supertokens.getAllCORSHeaders()],
    credentials: true,
    // highlight-end
}));

// highlight-next-line
app.use(middleware());

// ...your API routes
```
This `middleware` adds a few APIs (see all the APIs [here](https://app.swaggerhub.com/apis/supertokens/FDI)):
- `POST /auth/signinup`: For signing up/signing in a user using a thirdparty provider.

`/auth/` is a base path that [can be changed](../common-customizations/changing-base-path/api-base-path) if you want. 


</TabItem>
<TabItem value="loopback">

Add the `middleware` **BEFORE all your routes**.

```tsx
import supertokens from "supertokens-node";
import {middleware} from "supertokens-node/framework/loopback";

let app = new RestApplication({
    rest: {
        cors: {
            // highlight-start
            origin: "^{form_websiteDomain}",
            allowedHeaders: ["content-type", ...supertokens.getAllCORSHeaders()],
            credentials: true
            // highlight-end
        }
    }
});

// highlight-next-line
app.middleware(middleware);

// ...your API routes
```
This `middleware` adds a few APIs (see all the APIs [here](https://app.swaggerhub.com/apis/supertokens/FDI)):
- `POST /auth/signinup`: For signing up/signing in a user using a thirdparty provider.

`/auth/` is a base path that [can be changed](../common-customizations/changing-base-path/api-base-path) if you want. 


</TabItem>
</NodeJSFrameworkSubTabsServerless>
</TabItem>
<TabItem value="go">
<GoFrameworkSubTabs>
<TabItem value="http">

Use the `supertokens.Middleware` and the `supertokens.GetAllCORSHeaders()` functions as shown below.

```go
import (
	"net/http"
	"strings"

	"github.com/supertokens/supertokens-golang/supertokens"
)

func main() {
    // SuperTokens init...

    //highlight-start
	http.ListenAndServe("SERVER ADDRESS", corsMiddleware(
		supertokens.Middleware(http.HandlerFunc(func(rw http.ResponseWriter,
    //highlight-end
        r *http.Request) {
			// TODO: Handle your APIs..

		}))))
}

func corsMiddleware(next http.Handler) http.Handler {
	return http.HandlerFunc(func(response http.ResponseWriter, r *http.Request) {
		response.Header().Set("Access-Control-Allow-Origin", "^{form_websiteDomain}")
		response.Header().Set("Access-Control-Allow-Credentials", "true")
		if r.Method == "OPTIONS" {
			// we add content-type + other headers used by SuperTokens
			response.Header().Set("Access-Control-Allow-Headers",
				strings.Join(append([]string{"Content-Type"},
                //highlight-start
					supertokens.GetAllCORSHeaders()...), ","))
                //highlight-end
			response.Header().Set("Access-Control-Allow-Methods", "*")
			response.Write([]byte(""))
		} else {
			next.ServeHTTP(response, r)
		}
	})
}
```

</TabItem>
<TabItem value="gin">

Use the `supertokens.Middleware` and the `supertokens.GetAllCORSHeaders()` functions as shown below.

```go
import (
	"net/http"
	"time"

	"github.com/gin-contrib/cors"
	"github.com/gin-gonic/gin"
	"github.com/supertokens/supertokens-golang/supertokens"
)

func main() {
    // SuperTokens init...

	router := gin.New()

	// CORS
	router.Use(cors.New(cors.Config{
		AllowOrigins: []string{"^{form_websiteDomain}"},
		AllowMethods: []string{"GET", "POST", "DELETE", "PUT", "OPTIONS"},
		AllowHeaders: append([]string{"content-type"},
        // highlight-next-line
			supertokens.GetAllCORSHeaders()...),
		AllowCredentials: true,
	}))

	// Adding the SuperTokens middleware
    // highlight-start
	router.Use(func(c *gin.Context) {
		supertokens.Middleware(http.HandlerFunc(
			func(rw http.ResponseWriter, r *http.Request) {
				c.Next()
			})).ServeHTTP(c.Writer, c.Request)
		// we call Abort so that the next handler in the chain is not called, unless we call Next explicitly
		c.Abort()
	})
    // highlight-end

	// Add APIs and start server
}
```

</TabItem>
<TabItem value="chi">

Use the `supertokens.Middleware` and the `supertokens.GetAllCORSHeaders()` functions as shown below.

```go
import (
	"github.com/go-chi/chi"
	"github.com/go-chi/cors"
	"github.com/supertokens/supertokens-golang/supertokens"
)

func main() {
    // SuperTokens init...
    
	r := chi.NewRouter()

	// CORS
	r.Use(cors.Handler(cors.Options{
		AllowedOrigins: []string{"^{form_websiteDomain}"},
		AllowedMethods: []string{"GET", "POST", "PUT", "DELETE", "OPTIONS"},
		AllowedHeaders: append([]string{"Content-Type"},
			//highlight-next-line
			supertokens.GetAllCORSHeaders()...),
		AllowCredentials: true,
	}))

	// SuperTokens Middleware
	//highlight-next-line
	r.Use(supertokens.Middleware)

	// Add APIs and start server
}
```
</TabItem>
<TabItem value="mux">

Use the `supertokens.Middleware` and the `supertokens.GetAllCORSHeaders()` functions as shown below.

```go
import (
	"net/http"

	"github.com/gorilla/handlers"
	"github.com/gorilla/mux"
	"github.com/supertokens/supertokens-golang/supertokens"
)

func main() {
	// SuperTokens init...

	// Add APIs

	router := mux.NewRouter()

	// Adding handlers.CORS(options)(supertokens.Middleware(router)))
	//highlight-start
	http.ListenAndServe("SERVER ADDRESS", handlers.CORS(
		handlers.AllowedHeaders(append([]string{"Content-Type"},
			supertokens.GetAllCORSHeaders()...)),
		handlers.AllowedMethods([]string{"GET", "POST", "PUT", "HEAD", "OPTIONS"}),
		handlers.AllowedOrigins([]string{"^{form_websiteDomain}"}),
		handlers.AllowCredentials(),
	)(supertokens.Middleware(router)))
	//highlight-end
}
```
</TabItem>
</GoFrameworkSubTabs>

This `Middleware` adds a few APIs (see all the APIs [here](https://app.swaggerhub.com/apis/supertokens/FDI)):
- `POST /auth/signinup`: For signing up/signing in a user using a thirdparty provider.

`/auth/` is a base path that [can be changed](../common-customizations/changing-base-path/api-base-path) if you want. 

</TabItem>
</BackendSDKTabs>

</AppInfoForm>

## 5) Add the SuperTokens error handler
Add the `errorHandler` **AFTER all your routes**, but **BEFORE your error handler**

<BackendSDKTabs>
<TabItem value="nodejs">
<NodeJSFrameworkSubTabsServerless>
<TabItem value="express">

```jsx
let {errorHandler} = require("supertokens-node/framework/express");
// ...your API routes

// highlight-start
// Add this AFTER all your routes
app.use(errorHandler())
// highlight-end

// your own error handler
app.use((err, req, res, next) => {...});

```
</TabItem>
<TabItem value="hapi">

No additional `errorHandler` is required.

</TabItem>
<TabItem value="fastify">

Add the `errorHandler` **Before all your routes and plugin registration**

```jsx
let {errorHandler} = require("supertokens-node/framework/fastify");

// highlight-next-line
fastify.setErrorHandler(errorHandler());

// ...your API routes

```
</TabItem>
<TabItem value="koa">

No additional `errorHandler` is required.

</TabItem>
<TabItem value="loopback">

No additional `errorHandler` is required.

</TabItem>
</NodeJSFrameworkSubTabsServerless>
</TabItem>
<TabItem value="go">

:::info
You can skip this step
:::

</TabItem>
</BackendSDKTabs>

## 6) Test if sign up is setup correctly
- Go to the `/auth` route of your **website**
- Try to sign up.
- If after signing up, you are redirected to `/`, everything is setup correctly 😁
- If not, you can always ask for help via [Github issues](https://github.com/supertokens/supertokens-core/issues) or via [our Discord](https://supertokens.io/discord)


---------------

## Minimum setup completed 🎉🥳
Congratulations! You now have a fully functional login and session system!

The next steps is to setup your SuperTokens core instance.