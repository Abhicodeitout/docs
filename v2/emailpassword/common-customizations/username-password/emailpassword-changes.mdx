---
id: emailpassword-changes
title: Changes to the emailpassword flow
hide_title: true
show_ui_switcher: true
---

import BackendSDKTabs from "/src/components/tabs/BackendSDKTabs"
import TabItem from '@theme/TabItem';

# Changes to the emailpassword flow

Our approach will be to replace the `email` field in SuperTokens with the username field. This will enable username and password login as well as enforce username uniqueness.

Then we will save the optional email against the userID of the user and use that during sign in and reset password flows.

## Modifying the default email validator function
Whent the sign up / in API is called on the backend, SuperTokens first verifies the syntax of the input email. Since we want to replace emails with usernames, we need to change that function to allow for any `string`. We can do this in the following way:

<BackendSDKTabs>
<TabItem value="nodejs">

```tsx
import SuperTokens from "supertokens-node";
import EmailPassword from "supertokens-node/recipe/emailpassword";

SuperTokens.init({
    appInfo: {
        apiDomain: "...",
        appName: "...",
        websiteDomain: "..."
    },
    supertokens: {
        connectionURI: "...",
    },
    recipeList: [
        EmailPassword.init({
            signUpFeature: {
                formFields: [{
                    id: "email",
                    validate: async (value) => {
                        if (typeof value !== "string") {
                            return "Please provide a string input."
                        }
                        if (value.length < 3) {
                            return "Usernames must be at least 3 characters long."
                        }
                        if (!value.match(/^[a-z0-9_-]+$/)) {
                            return "Username must contain only alphanumeric, underscore or hyphen characters."
                        }
                    }
                }]
            }
        })
    ]
});
```

</TabItem>
<TabItem value="go">

```go
TODO
```

</TabItem>
<TabItem value="python">

```python
TODO
```

</TabItem>
</BackendSDKTabs>

The new `validate` function checks if the input username has at least three characters and contains only alphanumeric, underscore or hyphen characters. If this criteria doesn't match, then the sign up request is failed with the returned message. You can modify this function to be more complex and match your criteria.

You may have noticed that the `id` is still `"email"`. This is because from SuperTokens' point of view, we will still be storing the username in the SuperTokens' user's email field. This has no side effect other than you (the developer) having to fetch the user's username using the `user.email` field (where `user` is the user object returned by SuperTokens).

## Overriding the sign up API to save the user's email
TODO

## Overriding the sign in API to accept email or username
TODO

## Overriding the password reset link API to accept username or email
TODO

## Changing the frontend's email validator function
- For sign up / in
- For password reset

## Adding an optional email field in the sign up form
TODO

## Changing the form labels on the frontend to replace "Email" with "Username" 
TODO