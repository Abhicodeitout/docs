---
id: pre-api
title: Pre API Hook
hide_title: true
show_ui_switcher: true
---

import {PreBuiltOrCustomUISwitcher, PreBuiltUIContent, CustomUIContent} from "/src/components/preBuiltOrCustomUISwitcher"
import TabItem from '@theme/TabItem';
import FrontendPreBuiltUITabs from "/src/components/tabs/FrontendPreBuiltUITabs"
import FrontendCustomUITabs from "/src/components/tabs/FrontendCustomUITabs"
import NpmOrScriptTabs from "/src/components/tabs/NpmOrScriptTabs"
import FrontendMobileSubTabs from "/src/components/tabs/FrontendMobileSubTabs"
import AppInfoForm from "/src/components/appInfoForm"

# Pre API Hook

This function is called before any API call is being made to your backend from our frontend SDK. You can use this to change the request body / url / header or any other request property.

# Protecting frontend routes

<PreBuiltOrCustomUISwitcher>

<PreBuiltUIContent>


<FrontendPreBuiltUITabs>
<TabItem value="reactjs">

```tsx
import ThirdPartyEmailPassword from "supertokens-auth-react/recipe/thirdpartyemailpassword";

ThirdPartyEmailPassword.init({
    preAPIHook: async (context) => {
        let url = context.url;
        let requestInit = context.requestInit;
        
        let action = context.action;
        if (action === "EMAIL_EXISTS") {

        } else if (action === "EMAIL_PASSWORD_SIGN_IN") {

        } else if (action === "EMAIL_PASSWORD_SIGN_UP") {

        } else if (action === "GET_AUTHORISATION_URL") {

        } else if (action === "SEND_RESET_PASSWORD_EMAIL") {

        } else if (action === "SUBMIT_NEW_PASSWORD") {

        } else if (action === "THIRD_PARTY_SIGN_IN_UP") {
             // Note: this could either be sign in or sign up.
             // we don't know that at the time of the API call
             // since all we have is the authorisation code from
             // the social provider
        }

        // events such as sign out are in the 
        // session recipe pre API hook (See the info box below)

        return {
            requestInit, url
        };

    }
})
```


</TabItem>

:::info
Also checkout the [session recipe pre API hook](/docs/session/advanced-customizations/frontend-hooks/pre-api) for events such as sign out. These will need to go in the `Session.init` config object.
:::

</FrontendPreBuiltUITabs>

</PreBuiltUIContent>

<CustomUIContent>

<FrontendCustomUITabs>
<TabItem value="web">

<NpmOrScriptTabs>
<TabItem value="npm">

```tsx
import ThirdPartyEmailPassword from "supertokens-web-js/recipe/thirdpartyemailpassword"

ThirdPartyEmailPassword.init({
    postAPIHook: async (context) => {

        let action = context.action;
        if (action === "EMAIL_EXISTS") {

        } else if (action === "EMAIL_PASSWORD_SIGN_IN") {

        } else if (action === "EMAIL_PASSWORD_SIGN_UP") {

        } else if (action === "GET_AUTHORISATION_URL") {

        } else if (action === "SEND_RESET_PASSWORD_EMAIL") {

        } else if (action === "SUBMIT_NEW_PASSWORD") {

        } else if (action === "THIRD_PARTY_SIGN_IN_UP") {

        }

        // events such as sign out are in the 
        // session recipe pre API hook (See the info box below)
    },
})
```

</TabItem>
<TabItem value="script">

```tsx

import supertokensThirdPartyEmailPassword from "supertokens-web-js-script/recipe/thirdpartyemailpassword";

supertokensThirdPartyEmailPassword.init({
    postAPIHook: async (context) => {

        let action = context.action;
        if (action === "EMAIL_EXISTS") {

        } else if (action === "EMAIL_PASSWORD_SIGN_IN") {

        } else if (action === "EMAIL_PASSWORD_SIGN_UP") {

        } else if (action === "GET_AUTHORISATION_URL") {

        } else if (action === "SEND_RESET_PASSWORD_EMAIL") {

        } else if (action === "SUBMIT_NEW_PASSWORD") {

        } else if (action === "THIRD_PARTY_SIGN_IN_UP") {

        }

        // events such as sign out are in the 
        // session recipe pre API hook (See the info box below)
    },
})

```

</TabItem>
</NpmOrScriptTabs>

</TabItem>

<TabItem value="mobile">

<FrontendMobileSubTabs>

<TabItem value="reactnative">

react native

</TabItem>

<TabItem value="android">

```kotlin
import com.supertokens.session.CustomHeaderProvider;
import com.supertokens.session.SuperTokens;

// below code should go inside a method inside some method
new SuperTokens.Builder(context, Constants.apiDomain).customHeaderProvider(new CustomHeaderProvider() {
@Override
  public Map<String, String> getRequestHeaders(RequestType requestType) {
    if (requestType == RequestType.REFRESH) {
      Map<String, String> headers = new HashMap<>();
      headers.put("custom-header", "custom-value");

      return headers;
    }
    else if (requestType == RequestType.SIGNOUT) {
      Map<String, String> headers = new HashMap<>();
      headers.put("custom-header", "custom-value");

      return headers;
    }

    return null;
  }
})
.build();
```

</TabItem>

<TabItem value="ios">

```swift
import SuperTokensIOS

try SuperTokens.initialize(apiDomain: testAPIBase, tokenTransferMethod: .cookie, preAPIHook: {
  action, request in

  let mutableRequest = (request as NSURLRequest).mutableCopy() as! NSMutableURLRequest

  if action == .REFRESH_SESSION {
    mutableRequest.addValue("custom-value", forHTTPHeaderField: "custom-header")
  }
  
  if action == .SIGN_OUT {
    mutableRequest.addValue("custom-value", forHTTPHeaderField: "custom-header")
  }

  return mutableRequest.copy() as! URLRequest
})
```

</TabItem>

<TabItem value="flutter">

<AppInfoForm askForAPIDomain>

```dart
import 'package:supertokens/supertokens.dart';

SuperTokens.init(
    apiDomain: "^{form_apiDomain}",
    preAPIHook: (action, req) {
        if (action == APIAction.SIGN_OUT) {

        } else if (action == APIAction.REFRESH_TOKEN) {

        }
    return req;
});
```

</AppInfoForm>

</TabItem>

</FrontendMobileSubTabs>

</TabItem>

</FrontendCustomUITabs>

</CustomUIContent>

</PreBuiltOrCustomUISwitcher>
