import BackendSDKTabs from "/src/components/tabs/BackendSDKTabs";
import BackendSDKCasing from "/src/components/BackendSDKCasing"
import IntroductionSnippet from "/thirdpartyemailpassword/common-customizations/_change-password-introduction-snippet.mdx"
import EndingSnippet from "/thirdpartyemailpassword/common-customizations/_change-password-ending-snippet.mdx"
import TabItem from '@theme/TabItem';

<BackendSDKTabs>
<TabItem value="nodejs">

```jsx
// the following example uses express
let ^{recipeNameCapitalLetters} = require("supertokens-node/recipe/^{codeImportRecipeName}");
let Session = require("supertokens-node/recipe/session");
let { verifySession } = require("supertokens-node/recipe/session/framework/express");

app.get("/change-password", verifySession(), async (req, res) => {

    // TODO: see previous step

    // highlight-start
    // revoke all sessions for the user
    await Session.revokeAllSessionsForUser(userId)

    // revoke the current user's session, we do this to remove the auth cookies, logging out the user on the frontend.
    await Session.revokeSession(session.getHandle())
    //highlight-end

    res.send({
        status: response.status
    })

})

```
</TabItem>

<TabItem value="go">

```go

func main() {
    // Wrap the API handler in session.VerifySession
    session.VerifySession(nil, changePasswordAPI).ServeHTTP(rw, r)
}

type ResponseBody struct {
    OldPassword string
    NewPassword string
}

func changePasswordAPI(w http.ResponseWriter, r *http.Request) {

	// TODO: see previous step

    // highlight-start

    // revoke all sessions for the user
	_, err = session.RevokeAllSessionsForUser(userID)
	if err != nil {
		// TODO: Handle error
	}

    // revoke the user's current session, we do this to remove the auth cookies, logging out the user on the frontend
    _, err = session.RevokeSession(userID)
	if err != nil {
		// TODO: Handle error
	}

    // highlight-end

	resp := make(map[string]string)
    if response.OK != nil { 
        resp["status"] = "OK"
    } else {
        resp["status"] = "Could not update"
    }
	jsonResp, err := json.Marshal(resp)
	if err != nil {
		log.Fatalf("Error happened in JSON marshal. Err: %s", err)
	}
	w.Write(jsonResp)
}

```
</TabItem>

<TabItem value="python">

```python
from supertokens_python.recipe.session.framework.flask import verify_session
from supertokens_python.recipe.^{rid}.syncio import get_user_by_id, sign_in, update_email_or_password
from supertokens_python.recipe.session.syncio import revoke_all_sessions_for_user, revoke_session

@app.route('/change-password', methods=['POST'])
@verify_session()
def change_password():
    
    # TODO: see previous step

    # highlight-start
    # revoke all sessions for the user
    revoke_all_sessions_for_user(user_id)
    
    # revoke the user's current session, we do this to remove the auth cookies, logging out the user on the frontend
    revoke_session(session_.get_handle())
    # highlight-end
    return response.status

```
</TabItem>

</BackendSDKTabs>