---
id: handling-session-tokens
title: Handling session tokens
hide_title: true
---

<!-- COPY DOCS -->
<!-- ./thirdpartyemailpassword/custom-ui/handling-session-tokens.mdx -->

import FrontendCustomUITabs from "/src/components/tabs/FrontendCustomUITabs"
import NpmOrScriptTabs from "/src/components/tabs/NpmOrScriptTabs"
import FrontendMobileSubTabs from "/src/components/tabs/FrontendMobileSubTabs"

# Handling session tokens

## If using our frontend SDK

### For Web & React-Native

<!-- COPY SECTION -->
<!-- ./thirdpartyemailpassword/pre-built-ui/handling-session-tokens.mdx -->
<!-- 1 -->

import NetworkInterceptors from "/session/reusableMD/networkInterceptors.mdx"

Session tokens are sent as HTTP cookies as a result of user login. These tokens are automatically managed and refreshed by our frontend SDK.

The only code you need to write is to make sure that you have added our network interceptors as shown below

<NetworkInterceptors />

<!-- END COPY SECTION -->

### For Android

TODO Nemi

### For iOS

Coming soon

## If not using our frontend SDK

In this case, you will need to manually handle the tokens and session refreshing:

### On login
The login API will return the following headers:
- `Set-Cookie`: This will contain the `sAccessToken`, `sRefreshToken`, `sIdRefreshToken` cookies which will be `httpOnly` and will be automatically mananaged by the browser. For mobile apps, you will need to setup cookie handling yourself (or use our SDK - which does all this for you).
- `id-refresh-token` header: The value of this token is meaningless, but it changes whenever a session refreshes. This is useful when synchronising session refreshes (read later).
- `front-token` header: This contains information about the access token:
    - The userID
    - The expiry time of the access token
    - The payload added by you in the access token.
    
    Here is the structure of the token:
    ```tsx
    let frontTokenFromRequestHeader = "...";
    let frontTokenDecoded = JSON.parse(decodeURIComponent(escape(atob(frontTokenFromRequestHeader))));
    console.log(frontTokenDecoded);
    /*
    {
        ate: 1665226412455, // time in milliseconds for when the access token will expire, and then a refresh is required
        uid: "....", // user ID
        up: {
            ...
        } // custom payload added to the access token by you on the backend
    }
    
    */
    ```

    This is required because you don't have access to the actual access token on the frontend (for security reasons), but may want to read its payload (for example to know the user's role). This token itself is not signed and hence can't be used in place of the access token itself.

    You want to save this token in localstorage or in frontend cookies (using `document.cookies`).
- `anti-csrf` header (optional): By default it's not required, so it's not sent. But if this is sent, you should save this token as well for use when making requests.

### Making network requests to protected APIs
TODO

### Handling session refreshing
TODO

### Handling updates to access token
TODO

### Detecting session revocation
TODO

### Detecting session expiry
TODO

### Where to store values of `id-refresh-token` and `front-token`?
TODO